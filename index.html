<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Ütopya.net</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <a href="/index.html">
        <img src="/images/background/logo.png" alt="Ütopya.net">
      </a>
    </div>
    <ul>
      <li><a href="/index.html"><img src="/images/menu/ana-sayfa.png" alt="Ana Sayfa"></a></li>
      <li><a href="/parfumer/index.html"><img src="/images/menu/parfumer.png" alt="Parfümler"></a></li>
      <li><a href="/hediye-setleri.html"><img src="/images/menu/hediye-setleri.png" alt="Hediye Setleri"></a></li>
      <li><a href="/vintage.html"><img src="/images/menu/vintage.png" alt="Vintage"></a></li>
      <li><a href="/notalar.html"><img src="/images/menu/notalar.png" alt="Notalar"></a></li>
      <li><a href="/brands/index.html"><img src="/images/menu/markalar.png" alt="Markalar"></a></li>
      <li><a href="/hakkimizda.html"><img src="/images/menu/hakkimizda.png" alt="Hakkımızda"></a></li>
      <li><a href="/iletisim.html"><img src="/images/menu/iletisim.png" alt="İletişim"></a></li>
      <li><a href="/kampanyalar.html"><img src="/images/menu/kampanyalar.png" alt="Kampanyalar"></a></li>
    </ul>
  </aside>

  <!-- Topbar -->
  <header class="topbar">
    <div class="search-box">
      <form>
        <input type="text" placeholder="Parfüm ara..." class="search-input">
        <button type="submit">Ara</button>
      </form>
    </div>
    <nav class="user-menu">
      <ul>
        <li><a href="/uye-giris.html">Üye Girişi</a></li>
        <li><a href="/uye-kayit.html">Üye Kayıt</a></li>
        <li><a href="/siparis-takip.html">Sipariş Takip</a></li>
        <li><a href="/sepet.html">Sepetim</a></li>
        <li><a href="/favoriler.html">Favorilerim</a></li>
      </ul>
    </nav>
  </header>

  <!-- Slider -->
  <section class="slider">
    <img src="/images/slider/slide1.png" alt="Slide 1">
    <img src="/images/slider/slide2.png" alt="Slide 2">
    <img src="/images/slider/slide3.png" alt="Slide 3">
    <img src="/images/slider/slide4.png" alt="Slide 4">
  </section>

  <!-- Main Content -->
  <div class="main-content">
    <section class="products">
      <h2>Tüm Parfümler</h2>
      <div class="product-grid" id="productGrid"></div>
    </section>

    <!-- Checkout Form -->
    <section class="checkout">
      <h2>Ödeme</h2>
      <form id="payment-form">
        <div id="card-element"></div>
        <button type="submit">Ödeme Yap</button>
      </form>
    </section>
  </div>

  <script src="https://js.stripe.com/v3/"></script>
  <script>
    // Ürün grid doldurma
    fetch('/products.json')
      .then(res => res.json())
      .then(products => {
        const grid = document.getElementById('productGrid');
        grid.innerHTML = products.map(p => `
          <a href="${p.url}" class="product-card">
            <img src="${p.image}" alt="${p.name}">
            <h3>${p.brand} ${p.name}</h3>
            <p>${p.concentration} - ${p.ml}</p>
            <p class="price">${p.price || '₺___'}</p>
            <p>Stok: ${p.stock || '___'}</p>
          </a>
        `).join('');
      });

    // Slider otomatik geçiş
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slider img');
    function showSlide(index) {
      slides.forEach((slide, i) => {
        slide.style.display = (i === index) ? 'block' : 'none';
      });
    }
    function nextSlide() {
      currentSlide = (currentSlide + 1) % slides.length;
      showSlide(currentSlide);
    }
    showSlide(currentSlide);
    setInterval(nextSlide, 3000);

    // Stripe checkout
    const stripe = Stripe('STRIPE_PUBLIC_KEY'); // kendi public keyini buraya koy
    const elements = stripe.elements();
    const cardElement = elements.create('card');
    cardElement.mount('#card-element');

    const form = document.getElementById('payment-form');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const { token, error } = await stripe.createToken(cardElement);
      if (error) {
        alert(error.message);
      } else {
        const res = await fetch('/checkout', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ amount: 1000, currency: 'try', token: token.id })
        });
        const data = await res.json();
        if (data.success) {
          alert('Ödeme başarılı!');
        } else {
          alert('Ödeme hatası: ' + data.error);
        }
      }
    });
  </script>

</body>
</html>

